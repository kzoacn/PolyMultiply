#include"simd_poly.h"
#include <string.h>

void grade_school_mul_half(
    uint64_t        *res1,  /* out - a * b in Z[x], must be length 2N */
    uint64_t const  *a,     /*  in - polynomial */
    uint64_t const  *b,     /*  in - polynomial */
    uint64_t const   N)     /*  in - number of coefficients in a and b */
{
    uint64_t i;
    uint64_t j;

    for(j=0; j<N; j++)
    {
        res1[j] = a[0]*b[j];
    }
    for(i=1; i<N; i++)
    {
        for(j=0; i+j<N; j++)
        {
            res1[i+j] += a[i]*b[j];
        }
    }
    //res1[N] = 0;

    return;
}

inline void grade_school_mul_32(
    uint64_t        *r,  /* out - a * b in Z[x], must be length 2N */
    uint64_t const  *a,     /*  in - polynomial */
    uint64_t const  *b)     /*  in - polynomial */
{

uint64_t ai;
uint64_t const* b0;
uint64_t const* b1;
uint64_t const* b2;
uint64_t const* b3;
uint64_t* r0;
uint64_t* r1;
uint64_t* r2;
uint64_t* r3;
memset(r,0,64*sizeof(uint64_t));
ai=a[0];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+0;r1=r+1;r2=r+2;r3=r+3;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[1];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+1;r1=r+2;r2=r+3;r3=r+4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[2];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+2;r1=r+3;r2=r+4;r3=r+5;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[3];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+3;r1=r+4;r2=r+5;r3=r+6;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[4];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+4;r1=r+5;r2=r+6;r3=r+7;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[5];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+5;r1=r+6;r2=r+7;r3=r+8;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[6];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+6;r1=r+7;r2=r+8;r3=r+9;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[7];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+7;r1=r+8;r2=r+9;r3=r+10;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[8];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+8;r1=r+9;r2=r+10;r3=r+11;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[9];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+9;r1=r+10;r2=r+11;r3=r+12;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[10];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+10;r1=r+11;r2=r+12;r3=r+13;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[11];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+11;r1=r+12;r2=r+13;r3=r+14;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[12];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+12;r1=r+13;r2=r+14;r3=r+15;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[13];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+13;r1=r+14;r2=r+15;r3=r+16;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[14];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+14;r1=r+15;r2=r+16;r3=r+17;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[15];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+15;r1=r+16;r2=r+17;r3=r+18;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[16];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+16;r1=r+17;r2=r+18;r3=r+19;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[17];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+17;r1=r+18;r2=r+19;r3=r+20;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[18];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+18;r1=r+19;r2=r+20;r3=r+21;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[19];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+19;r1=r+20;r2=r+21;r3=r+22;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[20];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+20;r1=r+21;r2=r+22;r3=r+23;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[21];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+21;r1=r+22;r2=r+23;r3=r+24;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[22];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+22;r1=r+23;r2=r+24;r3=r+25;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[23];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+23;r1=r+24;r2=r+25;r3=r+26;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[24];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+24;r1=r+25;r2=r+26;r3=r+27;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[25];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+25;r1=r+26;r2=r+27;r3=r+28;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[26];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+26;r1=r+27;r2=r+28;r3=r+29;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[27];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+27;r1=r+28;r2=r+29;r3=r+30;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[28];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+28;r1=r+29;r2=r+30;r3=r+31;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[29];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+29;r1=r+30;r2=r+31;r3=r+32;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[30];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+30;r1=r+31;r2=r+32;r3=r+33;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
ai=a[31];
b0=b;b1=b+1;b2=b+2;b3=b+3;
r0=r+31;r1=r+32;r2=r+33;r3=r+34;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
*r0+=ai*(*b0);
*r1+=ai*(*b1);
*r2+=ai*(*b2);
*r3+=ai*(*b3);
r0+=4;r1+=4;r2+=4;r3+=4;b0+=4;b1+=4;b2+=4;b3+=4;
  return;
}



uint64_t up(uint64_t x){
	uint64_t ans=1,i;
	for(i=1;i<=30;i++){
		if((1<<i) > x)
			return 1<<i;
	}
}

 void karatsuba(
    uint64_t        *r, /* out - a * b in Z[x], must be length 2n */
    uint64_t        *t, /*  in - n coefficients of scratch space */
    uint64_t const  *a, /*  in - polynomial */
    uint64_t const  *b, /*  in - polynomial */
    uint64_t const   n) /*  in - number of coefficients in a and b */

{
    if (n < 64)
    {
    	if(n==32)
    		grade_school_mul_32(r,a,b);
        else 
        	grade_school_mul_optim(r, a, b, n);
        return;
    }
    uint64_t i;
    uint64_t s = n/2;
    uint64_t const *a1 = a+s;
    uint64_t const *b1 = b+s;
    uint64_t *t1 = t+s;
    uint64_t *r1 = r+s, *r2 = r+2*s, *r3 = r+3*s;
    for(i=0; i<s; i++)
    {
        r[i] = a[i]-a1[i];
        r1[i] = b1[i]-b[i];
    }
    karatsuba(t, r2, r, r1, s);
    karatsuba(r2, r, a1, b1, s);
    for(i=0; i<s; i++)
    {
        r1[i] = r2[i] + t[i];
        r2[i] += r3[i] + t1[i];
    }
    karatsuba(t, r, a, b, s);
    for(i=0; i<s; i++)
    {
        r[i] = t[i];
        r1[i] += t[i] + t1[i];
        r2[i] += t1[i];
    }
    return;
}

void karatsuba_half(
    uint64_t        *r, /* out - a * b in Z[x], must be length 2n */
    uint64_t        *t, /*  in - n coefficients of scratch space */
    uint64_t const  *a, /*  in - polynomial */
    uint64_t const  *b, /*  in - polynomial */
    uint64_t const   n) /*  in - number of coefficients in a and b */

{
    if (n < 256)
    {
        grade_school_mul_half_optim(r, a, b, n);
        return;
    }
    uint64_t i;
    uint64_t s = n/2;
    uint64_t const *a1 = a+s;
    uint64_t const *b1 = b+s;
    uint64_t *t1 = t+s;
    uint64_t *r1 = r+s, *r2 = r+2*s, *r3 = r+3*s;

    
    karatsuba_half(t, r2, a, b1, s);
    

    karatsuba_half(r1, r, a1, b, s);

    for(i=0; i<s; i++)
    {
        r1[i] += t[i];
    }
    karatsuba(t, r2, a, b, s);
    
    
    
    for(i=0; i<s; i++)
    {
        r[i] = t[i];
        r1[i] +=  t1[i];
    }
    
    return;
}

void karatsuba_768(
    uint64_t        *r, 
    uint64_t        *t, 
    uint64_t const  *a, 
    uint64_t const  *b, 
    uint64_t const   n) 

{
	const uint64_t m=256;
	uint64_t i;
	uint64_t* r0=r;
	uint64_t* r1=r+m;
	uint64_t* r2=r+m*2;
	uint64_t* r3=r+m*3;
	
	uint64_t const * a0=a;
	uint64_t const * a1=a+m;
	uint64_t const * a2=a+m*2;
	
	uint64_t const * b0=b;
	uint64_t const * b1=b+m;
	uint64_t const * b2=b+m*2;
	
	uint64_t* t0=t;
	uint64_t* t1=t+m;
	uint64_t* t2=t+m*2;
	uint64_t* t3=t+m*3;
	uint64_t* t4=t+m*4;
	uint64_t* t5=t+m*5;
	uint64_t* t6=t+m*6;
	
	//karatsuba_half(t0,r3,a2,b0,m);
	//karatsuba_half(r2,r3,a0,b2,m);
	grade_school_mul_half_optim(t0,a2,b0,m);
	grade_school_mul_half_optim(r2,a0,b2,m);
	for(i=0;i<m;i++){
		r2[i]+=t[i];
	}
	
	
    for(i=0; i<m; i++)
    {
        r0[i] = a0[i]+a1[i];
        r1[i] = b0[i]+b1[i];
    }
    karatsuba(t4, r3,r0, r1, m);
    //grade_school_mul_256(t4, r0, r1);
	
	karatsuba(t0,r3,a1,b1,m);
	//grade_school_mul_256(t0,a1,b1);
	for(i=0;i<m;i++){
		r2[i]+=t0[i];
		t4[i]-=t0[i];
		t5[i]-=t1[i];
	}
	karatsuba(t0,r3,a0,b0,m);
	//grade_school_mul_256(t0,a0,b0);
	
	for(i=0;i<m;i++){
		r0[i]=t0[i];
		r1[i]=t1[i];
		
		t4[i]-=t0[i];
		t5[i]-=t1[i];
	}
	for(i=0;i<m;i++){
		r1[i]+=t4[i];
		r2[i]+=t5[i];
	}
}
int n;
int h(uint64_t *r){
	int ans=0,i;
	for(i=0;i<n;i++)
		ans=ans*233+r[i];
	return ans;
}

#define TEST(multiply) \
	puts(#multiply);\
	st=clock();\
	multiply(r,t,a,b,n); \
	printf("%.8f\n",(clock()-st)/CLOCKS_PER_SEC);\
	printf("hash=%d\n",h(r));

uint64_t a[111111];
uint64_t b[111111];
uint64_t c[111111];
uint64_t r[111111];
uint64_t t[111111];
int main(){
	n=768;
	for(uint64_t i=0;i<n;i++){
		a[i]=rand()%100;
		b[i]=rand()%100;
	}
	
	double st;	
	
	
	TEST(karatsuba_768);
	TEST(karatsuba);
	TEST(karatsuba_old);
	TEST(karatsuba_old_optim);
	TEST(karatsuba_old_optim2);
	
	puts("grade_school_mul");
	st=clock();
	grade_school_mul(r,a,b,n); 
	printf("%.8f\n",(clock()-st)/CLOCKS_PER_SEC);
	printf("hash=%d\n",h(r));

	
	puts("grade_school_mul_optim");
	grade_school_mul_optim(r,a,b,n); 
	printf("%.8f\n",(clock()-st)/CLOCKS_PER_SEC);
	printf("hash=%d\n",h(r));
	

	return 0;
}
